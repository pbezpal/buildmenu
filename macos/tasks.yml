---
- name: Export source to MacOS
  synchronize:
      src: '{{local_src_dir}}/../darwin'
      dest: ~/build
      recursive: yes
- name: Build DMG
  command: '/usr/local/bin/node /usr/local/bin/electron-installer-dmg roschat-darwin-x64/roschat.app --overwrite RosChat-{{tag}}'
  args:
      chdir: ~/build/darwin/
- name: Fetch DMG
  fetch:
      src: '~/build/darwin/RosChat-{{tag}}.dmg'
      dest: '{{local_src_dir}}/../setup/dmg/'
      flat: yes
